---
functions:
  file-read:
  - binary: false
    code: |-
      touch x.yara
      clamscan --no-summary -d x.yara -f /path/to/input-file 2>&1 | sed -nE 's/^(.*): No such file or directory$/\1/p'
    comment: |-
      Each line of the file is interpreted as a path and the content is leaked via error messages. The output can optionally be cleaned using `sed`.
    contexts:
      sudo:
      suid:
      unprivileged:
...
