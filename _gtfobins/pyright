---
comment: |-
  pyright is a static type checker for Python. It can be abused to read arbitrary files via error messages and JSON output, leaking sensitive information.
functions:
  file-read:
  - code: |-
      pyright secret.txt
    contexts:
      unprivileged:
        comment: |-
          Parses arbitrary files and leaks content through error messages.
  - code: |-
      pyright --outputjson secret.txt
    contexts:
      unprivileged:
        comment: |-
          Outputs diagnostics in JSON format, exposing file paths, line numbers, and snippets of content.
  - code: |-
      pyright -w .
    contexts:
      unprivileged:
        comment: |-
          Recursively walks directories, parsing all files (renamed to .py) and leaking their contents through diagnostics.
...
